(this["webpackJsonptimetable-builder"]=this["webpackJsonptimetable-builder"]||[]).push([[0],{122:function(e,t,a){},143:function(e,t,a){e.exports=a(230)},148:function(e,t,a){},170:function(e,t,a){},230:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(17),c=a.n(s),l=(a(148),a(149),a(46)),i=a(14),o=a(21),u=a(22),m=a(24),d=a(23),h=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-dark bg-dark navbar-expand-lg"},r.a.createElement(l.b,{to:"/",className:"navbar-brand"},"Timetable Builder"),r.a.createElement("div",{className:"collpase navbar-collapse"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement("li",{className:"navbar-item"},r.a.createElement(l.b,{to:"/",className:"nav-link"},"Courses")),r.a.createElement("li",{className:"navbar-item"},r.a.createElement(l.b,{to:"/timetable",className:"nav-link"},"Build Timetable")))))}}]),a}(n.Component),p=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("footer",{className:"page-footer mt-4"},r.a.createElement("div",{className:"footer-copyright text-center py-3"},"Made by Jason Tian, using Slash GraphQL"))}}]),a}(n.Component),f=a(16),v=a(32),E=a.n(v),b=a(79),g=a(138),y=a(123),k=(a(170),a(253)),C=a(252),O=["Monday","Tuesday","Wednesday","Thursday","Friday"];var S=function(e){return r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"Lecture ",e.date[0].section),r.a.createElement("td",null,e.date.map((function(e){return r.a.createElement(r.a.Fragment,null,O[e.dayOfWeek-1]," ",e.startTime,":00"," - ",e.endTime,":00",r.a.createElement("br",null))}))),r.a.createElement("td",null,"-"),r.a.createElement("td",null,"---"))},N=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={setShow:!1,course:e.props.course},e}return Object(u.a)(a,[{key:"courseInfo",value:function(){for(var e=[],t=[],a=1;a<=this.state.course.sections;a++){var n,s=Object(y.a)(this.state.course.dates.entries());try{for(s.s();!(n=s.n()).done;){var c=Object(g.a)(n.value,2),l=(c[0],c[1]);l.section===a&&e.push(l)}}catch(i){s.e(i)}finally{s.f()}t.push(r.a.createElement(S,{date:e})),e=[]}return t}},{key:"render",value:function(){var e=this,t=function(){return e.setState({setShow:!1})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{variant:"primary",onClick:function(){return e.setState({setShow:!0})}},"Details"),r.a.createElement(C.a,{show:this.state.setShow,size:"lg",onHide:t,backdrop:"static",keyboard:!1},r.a.createElement(C.a.Header,{closeButton:!0},r.a.createElement(C.a.Title,null,"Course Information")),r.a.createElement(C.a.Body,null,r.a.createElement("table",{className:"table table-striped table-bordered"},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Activity"),r.a.createElement("th",{scope:"col"},"Time"),r.a.createElement("th",{scope:"col"},"Location"),r.a.createElement("th",{scope:"col"},"Instructor"))),r.a.createElement("tbody",null,this.courseInfo()))),r.a.createElement(C.a.Footer,null,r.a.createElement(k.a,{variant:"primary",onClick:t},"Close"))))}}]),a}(n.Component),j=a(99),T=a(100),w=a.n(T);function D(){var e=Object(j.a)(["\n  {\n    queryCourse(first: 100) {\n      code\n      dates(first: 50) {\n        dayOfWeek\n        endTime\n        location\n        section\n        startTime\n      }\n      description\n      instructor\n      discipline_id\n      name\n      sections\n    }\n  }\n"]);return D=function(){return e},e}function P(){var e=Object(j.a)(["\n  {\n    queryDiscipline(first: 100) {\n      id\n      name\n    }\n  }\n"]);return P=function(){return e},e}var x=w()(P()),L=w()(D()),W=a(250),F=function(e){return r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},e.course.name),r.a.createElement("td",null,e.course.code),r.a.createElement("td",null,e.course.description),r.a.createElement("td",null,r.a.createElement(N,{course:e.course})))},q=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateSelectedDisciplines=function(e){n.setState({selectedOptions:e},(function(){if(e){console.log(e);var t=[];e.forEach((function(e){t.push(e.value)})),n.setState({selectedDisciplines:t})}else n.setState({selectedDisciplines:[]})}))},n.deleteCourse=n.deleteCourse.bind(Object(f.a)(n)),n.createDisciplineList=n.createDisciplineList.bind(Object(f.a)(n)),n.state={courses:[],disciplines:[],selectedDisciplines:[]},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;E.a.get("http://localhost:5000/courses/").then((function(t){e.setState({courses:t.data})})).catch((function(e){console.log(e)})),E.a.get("http://localhost:5000/disciplines/").then((function(t){e.setState({disciplines:t.data})})).catch((function(e){console.log(e)}))}},{key:"deleteCourse",value:function(e){E.a.delete("http://localhost:5000/courses/"+e).then((function(e){console.log(e.data)})),this.setState({courses:this.state.courses.filter((function(t){return t._id!==e}))})}},{key:"courseList",value:function(e){var t=this;return this.state.courses=e,this.state.courses.map((function(e){return t.state.selectedDisciplines.length,r.a.createElement(F,{course:e,deleteCourse:t.deleteCourse,key:e._id})}))}},{key:"createDisciplineList",value:function(e){var t=this;return this.state.disciplines=[],e.map((function(e){t.state.disciplines.push(e)})),r.a.createElement("div",null,r.a.createElement(b.a,{options:this.disciplineList(this.state.disciplines),isSearchable:"true",isMulti:"true",value:this.disciplineList(this.getSelectedDisciplines),placeholder:"Filter by Discipline",onChange:this.updateSelectedDisciplines}))}},{key:"disciplineList",value:function(e){if(void 0!==e){var t=[];return e.map((function(e){t.push({value:e.name,label:e.name})})),t}}},{key:"render",value:function(){var e=this;this.state.selectedDisciplines;return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-3"},r.a.createElement(W.a,{query:x},(function(t){var a=t.loading,n=t.error,s=t.data;if(a)return r.a.createElement("div",null,"Fetching");if(n)return r.a.createElement("div",null,"Error");var c=s.queryDiscipline;return r.a.createElement("div",null,e.createDisciplineList(c))}))),r.a.createElement("div",{className:"col-lg-9"},r.a.createElement("h3",null,"Courses Offered"),r.a.createElement("table",{className:"table table-striped table-bordered"},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Name"),r.a.createElement("th",{scope:"col"},"Code"),r.a.createElement("th",{scope:"col"},"Description"),r.a.createElement("th",{scope:"col"},"Actions"))),r.a.createElement(W.a,{query:L},(function(t){var a=t.loading,n=t.error,s=t.data;if(a)return r.a.createElement("div",null,"Fetching");if(n)return r.a.createElement("div",null,"Error");var c=s.queryCourse;return r.a.createElement("tbody",null,e.courseList(c))}))))))}}]),a}(n.Component),M=a(88),I=a.n(M),A=(a(112),function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChangeUsername=n.onChangeUsername.bind(Object(f.a)(n)),n.onChangeDescription=n.onChangeDescription.bind(Object(f.a)(n)),n.onChangeDuration=n.onChangeDuration.bind(Object(f.a)(n)),n.onChangeDate=n.onChangeDate.bind(Object(f.a)(n)),n.onSubmit=n.onSubmit.bind(Object(f.a)(n)),n.state={username:"",description:"",duration:0,date:new Date,users:[]},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;E.a.get("http://localhost:5000/exercises/"+this.props.match.params.id).then((function(t){e.setState({username:t.data.username,description:t.data.description,duration:t.data.duration,date:new Date(t.data.date)})})).catch((function(e){console.log(e)})),E.a.get("http://localhost:5000/users/").then((function(t){t.data.length>0&&e.setState({users:t.data.map((function(e){return e.username}))})})).catch((function(e){console.log(e)}))}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangeDescription",value:function(e){this.setState({description:e.target.value})}},{key:"onChangeDuration",value:function(e){this.setState({duration:e.target.value})}},{key:"onChangeDate",value:function(e){this.setState({date:e})}},{key:"onSubmit",value:function(e){e.preventDefault();var t={username:this.state.username,description:this.state.description,duration:this.state.duration,date:this.state.date};console.log(t),E.a.post("http://localhost:5000/exercises/update/"+this.props.match.params.id,t).then((function(e){return console.log(e.data)})),window.location="/"}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Edit Exercise Log"),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Username: "),r.a.createElement("select",{ref:"userInput",required:!0,className:"form-control",value:this.state.username,onChange:this.onChangeUsername},this.state.users.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Description: "),r.a.createElement("input",{type:"text",required:!0,className:"form-control",value:this.state.description,onChange:this.onChangeDescription})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Duration (in minutes): "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.duration,onChange:this.onChangeDuration})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Date: "),r.a.createElement("div",null,r.a.createElement(I.a,{selected:this.state.date,onChange:this.onChangeDate}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"submit",value:"Edit Exercise Log",className:"btn btn-primary"}))))}}]),a}(n.Component)),_=(n.Component,a(28)),B=a.n(_),U=a(50),G=(a(122),a(251)),J=function(e){if(null!==e.day){var t=e.startTime-8+2+(e.startTime-8),a=e.endTime-8+2+(e.endTime-8),n=String(e.dayOfWeek+1)+" / "+String(e.dayOfWeek+2),s={backgroundColor:"rgb(".concat(e.color,")"),fontSize:"14px",gridRowStart:t,gridRowEnd:a,gridColumn:n};return r.a.createElement(G.a,{elevation:3,style:s,className:"tableElement"},e.courseName,r.a.createElement("br",null),e.code,r.a.createElement("br",null),"Section: ",e.section)}return null},z=a(139);function H(e){return 2*(e-8)}function R(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(U.a)(B.a.mark((function e(t,a){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t;console.log("TIMES"+r+":"+a);for(var s=!0,c=Array(5).fill(0).map((function(e){return Array(27).fill(0)})),l=0;l<r.length;l++)for(var i=0;i<r[l].dates.length;i++){var o=r[l].dates[i];if(o.section===a[l])for(var u=o.startTime;u<o.endTime;u++){if(1===c[o.dayOfWeek-1][H(u)]){s=!1;break}c[o.dayOfWeek-1][H(u)]=1}}e(s)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t,a){return V.apply(this,arguments)}function V(){return(V=Object(U.a)(B.a.mark((function e(t,a,n){var r,s,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(){return(c=Object(U.a)(B.a.mark((function e(t,a,n){var c,l;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length===a)R(t,n).then((function(e){e&&r.push(n)}));else for(c=1;c<=t[a].sections;c++)(l=Object(z.a)(n)).push(c),s(t,a+1,l);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},s=function(e,t,a){return c.apply(this,arguments)},r=[],e.abrupt("return",new Promise((function(e,c){s(t,a,n).then((function(t){e(r)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return(X=Object(U.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K(t,0,[]).then((function(e){return e})).then((function(e){return console.table(e),e})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=a(94),Z=["Monday","Tuesday","Wednesday","Thursday","Friday"],$=function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.course.name),r.a.createElement("td",null,e.course.code),e.course.dates.map((function(e,t){return r.a.createElement("div",{class:"row"},r.a.createElement("td",{key:e._id},Z[e.dayOfWeek-1]," ",e.startTime," - ",e.endTime))})),r.a.createElement("td",null,e.course.dates.map((function(e,t){return r.a.createElement("div",{class:"row"},r.a.createElement("td",{key:e._id},e.section))}))))},ee=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).updateSelect=function(e){n.setState({selectedOptions:e},(function(){n.setState({selectedCourses:n.getSelectedCourses()})}))},n.generate=n.generate.bind(Object(f.a)(n)),n.nextTime=n.nextTime.bind(Object(f.a)(n)),n.prevTime=n.prevTime.bind(Object(f.a)(n)),n.state={courses:[],selectedOptions:[],selectedCourses:[],allTimes:[],currentPage:0,totalPage:0},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){}},{key:"courseList",value:function(){var e=this;return this.state.courses.map((function(t){var a=[];if(e.state.selectedOptions&&(e.state.selectedOptions.map((function(e){a.push(e.value)})),a.includes(t.name)))return r.a.createElement($,{course:t,deleteCourse:e.deleteCourse,key:t._id})}))}},{key:"courseNameList",value:function(){var e=[];return this.state.courses.map((function(t){e.push({value:t.name,label:t.name})})),e}},{key:"getSelectedCourses",value:function(){var e=this,t=[];return this.state.courses.map((function(a){var n=[];e.state.selectedOptions&&(e.state.selectedOptions.map((function(e){n.push(e.value)})),n.includes(a.name)&&t.push([a,-1]))})),t}},{key:"showDayOfWeek",value:function(){var e=[];return e.push(r.a.createElement("div",null,"Time")),Z.map((function(t){e.push(r.a.createElement("div",null,t))})),r.a.createElement(r.a.Fragment,null,e)}},{key:"showTime",value:function(){for(var e=[],t=8;t<=20;t++){var a=t;a>12&&(a-=12),e.push(r.a.createElement("div",null,a,":00")),e.push(r.a.createElement("div",null,a,":30"))}return e.push(r.a.createElement("div",null,"9:00")),r.a.createElement(r.a.Fragment,null,e)}},{key:"renderDates",value:function(e){var t=[];return console.log(e[0]),e[0].dates.map((function(a){a.section===e[1]&&t.push(r.a.createElement(J,{key:e[0].code,color:[180,180,255],startTime:a.startTime,endTime:a.endTime,dayOfWeek:a.dayOfWeek,section:a.section,code:e[0].code,courseName:e[0].name,description:e[0].description}))})),t}},{key:"getCourseNames",value:function(){var e=Object(U.a)(B.a.mark((function e(){var t,a=this;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.abrupt("return",new Promise((function(e,n){a.state.selectedCourses.map((function(e){t.push(e[0].name)})),Promise.all(t).then((function(t){e(t)}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"updateTimes",value:function(){var e=this,t=0,a=this.state.selectedCourses.map((function(a){return new Promise((function(n,r){var s=[];s.push(a[0]);var c=e.state.allTimes[e.state.currentPage-1][t];return s.push(c),t++,n(s)}))}));Promise.all(a).then((function(t){console.log(t),e.setState({selectedCourses:t})}))}},{key:"generate",value:function(){var e=this,t=this.state.selectedCourses[0];this.state.selectedCourses.length>0&&(t.pop(),console.log(t),console.log("generated"),function(e){return X.apply(this,arguments)}(t).then((function(t){console.log(t),e.setState({allTimes:t,currentPage:1,totalPage:t.length},(function(){0===e.state.totalPage?e.setState({currentPage:0}):e.updateTimes()}))})))}},{key:"nextTime",value:function(){var e=this;this.state.currentPage<this.state.totalPage&&this.setState({currentPage:this.state.currentPage+1},(function(){e.updateTimes()}))}},{key:"prevTime",value:function(){var e=this;this.state.currentPage>1&&this.setState({currentPage:this.state.currentPage-1},(function(){e.updateTimes()}))}},{key:"createSelectedCourses",value:function(e,t){var a=this;return this.state.courses=[],e.map((function(e){a.state.courses.push(e)})),r.a.createElement("div",null,r.a.createElement(b.a,{options:this.courseNameList(),isSearchable:"true",isMulti:"true",value:t,placeholder:"Choose courses",onChange:this.updateSelect}))}},{key:"render",value:function(){var e=this,t=this.state.selectedOptions;return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-5"},r.a.createElement("p",null,"Select at least 1 course and press Generate Timetables to see the magic!"),r.a.createElement("h3",null,"Selected Courses"),r.a.createElement(W.a,{query:L},(function(a){var n=a.loading,s=a.error,c=a.data;if(n)return r.a.createElement("div",null,"Fetching");if(s)return r.a.createElement("div",null,"Error");var l=c.queryCourse;return r.a.createElement(r.a.Fragment,null,e.createSelectedCourses(l,t))})),r.a.createElement("table",{className:"table table-striped table-bordered"},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Code"),r.a.createElement("th",null,"Dates"),r.a.createElement("th",null,"Section"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,this.courseList()))),r.a.createElement("div",{className:"col-lg-7"},r.a.createElement("button",{className:"btn btn-primary generate",onClick:this.generate},"Generate Timetables"),r.a.createElement("button",{className:"btn btn-secondary generate",onClick:this.prevTime},r.a.createElement("b",null,"<")),r.a.createElement("span",{className:"generate"},r.a.createElement("b",null,this.state.currentPage,"/",this.state.totalPage)),r.a.createElement("button",{className:"btn btn-secondary generate",onClick:this.nextTime},r.a.createElement("b",null,">")),r.a.createElement("p",null,"Scroll through generated timetables!"),r.a.createElement("div",{className:"timetable"},r.a.createElement("section",{className:"dayOfWeekWrapper"},this.showDayOfWeek()),r.a.createElement("section",{className:"timeWrapper"},this.showTime()),this.state.selectedCourses.map((function(t){return e.renderDates(t)}))))))}}]),a}(n.Component);var te=function(){return r.a.createElement(l.a,null,r.a.createElement(h,null),r.a.createElement("br",null),r.a.createElement("div",{className:"container"},r.a.createElement(i.a,{path:"/",exact:!0,component:q}),r.a.createElement(i.a,{path:"/edit/:id",component:A}),r.a.createElement(i.a,{path:"/timetable",component:ee})),r.a.createElement(p,null))},ae=a(81),ne=Object(ae.b)({name:"selectedCourses",initialState:{value:[]},reducers:{setCourses:function(e,t){e.selectedCourses=t.payload}}}),re=(ne.actions.setCourses,ne.reducer),se=(Object(ae.a)({reducer:{selectedCourses:re}}),a(229),a(45)),ce=a(137),le=a(140),ie=a(15),oe=a(136),ue=new ce.a,me=new le.a({uri:"https://bent-dog.us-west-2.aws.cloud.dgraph.io/graphql"}),de=new se.a({cache:ue,link:me});c.a.render(r.a.createElement(ie.a,{client:de},r.a.createElement(Y.a,{template:oe.a},r.a.createElement(te,null))),document.getElementById("root"))}},[[143,1,2]]]);
//# sourceMappingURL=main.95982d59.chunk.js.map